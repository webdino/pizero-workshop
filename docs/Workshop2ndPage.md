
## 設定応用編
ここからは、さらに便利につかっていくための説明をしていきます。

### 計測間隔を設定する

いまは１分ごとに計測しています。

`config.js`の編集

interval_millisec

Machinist は同じ分に送ったデータは後で送ったもので上書きし、1分に 1 計測以上を送信できないことに注意
Ambient は間隔は自由だが 1 日辺りの上限があり定期送信なら 30 秒ごとが最短であることに注意。

### データ送信間隔を設定する

複数回の計測値をまとめて送信することができます。

これにより通信量を減らすことができます - IoT SIM 通信など用

`config.js`の編集

multiple

### Machinistのいろいろな機能をつかってみる

- グラフ表示の使い方
  - 各メトリックを開く
  - 最新値、1日などの切り替え
    - 最新値以外の表示では一定時間の結果を算術平均した丸め値の表示となること
    - その丸め値の計算は即座に行われるものだけじゃなく、すぐに描画に反映されないことがある。あくまでも過去の大きな変動観察用
    - 長期間の表示では丸められている結果、最小値や最大値が欲しいケースに使えないことに注意
  - 最新値、1日などの切り替え
  - 最新値、1日などの切り替え
  - 表示する時間の切り替え
- 監視機能
  1. アクションにメール通知を登録する https://app.machinist.iij.jp/action-settings
  2. 監視設定を追加する https://app.machinist.iij.jp/monitor/settings
    - 死活監視 (メトリックが15分途切れたら通知)
    - 閾値監視 (メトリックの直近 5 分平均などが一定値を超えたら通知)
- カスタムチャート・ダッシュボード
  - 高校生向けでは無しでも良いが、大人向けに説明を
  - カスタムチャートの公開やダッシュボードで監視ディスプレイを設置する
- IFTTT 連携 - ここには書き切れないが LINE 通知などするために本当は必要な話


通知メールの例 (死活監視)

```
送信者: machinist-noreply@iij.ad.jp
タイトル: "Machinist監視通知"
-----
監視状態に変化がありました
 (YYYY/MM/DD HH:MM:SS)

エージェント: xxxxxxxx
メトリック:   2JCIE-BU / 温度
タグ:         {}
状態:         未設定 -> 計測中断！
条件:         死活監視

詳細は以下のページよりご確認ください。
https://app.machinist.iij.jp/#/metrics/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

machinist-noreply@iij.ad.jp は送信専用のメールアドレスです
```

通知メールの例 (しきい値)

```
送信者: machinist-noreply@iij.ad.jp
タイトル: "Machinist監視通知"
-----
監視状態に変化がありました
 (YYYY/MM/DD HH:MM:SS)

エージェント: xxxxxxxx
メトリック:   2JCIE-BU / 総揮発性有機化合物濃度
タグ:         {}
状態:         未設定 -> 揮発してます！
条件:         1554.0(avg) > 1000.0


詳細は以下のページよりご確認ください。
https://app.machinist.iij.jp/#/metrics/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

machinist-noreply@iij.ad.jp は送信専用のメールアドレスです
```


### 別のクラウドサービス（Ambient）にアップロードしてみる

[Ambientでユーザアカウントをつくる]()の手順に沿って進めます。

`config.js`の編集

- 詳しくは後日、ここでは最小限の数行説明で良い

### microSDカードのCSVファイルに

- カード抜いたらここに csv ファイルあるよ
- 古いデータは自動でファイル名を変えて分割するよ


### Googleドライブにアップロードする

自動で定期的にgoogleドライブにアップロードすることができます。

google driveの設定　　rclone

- rclone の使い鷹は取りあえず後回し。設定ファイルを作って下さいだけとして、テンプレートを別途渡す
- rclone されるタイミングは再起動したときと日付が変わったとき (rsync と同時で不味い問題はあるが言及しない。rclone が共有キーで超遅い接続にしている限り rsync の方が先に終わるとある程度は期待でき、ワークショップ中は多分何とかなる)




## raspberrypi zeroへアクセス
ここからはくわしい人向けになりますが、hostname otg serial_console
